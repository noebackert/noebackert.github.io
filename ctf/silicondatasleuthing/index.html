<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Silicon Data Sleuthing | Noé Backert | Blog</title><meta name=keywords content="Forensics,ROM,Firmware"><meta name=description content="In the dust and sand surrounding the vault, you unearth a rusty PCB... You try to read the etched print, it says Open...W...RT, a router! You hand it over to the hardware gurus and to their surprise the ROM Chip is intact! They manage to read the data off the tarnished silicon and they give you back a firmware image. It's now your job to examine the firmware and maybe recover some useful information that will be important for unlocking and bypassing some of the vault's countermeasures!"><meta name=author content="Noé Backert"><link rel=canonical href=https://www.noe.backert.fr/ctf/silicondatasleuthing/><link crossorigin=anonymous href=/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://www.noe.backert.fr/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.noe.backert.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.noe.backert.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://www.noe.backert.fr/apple-touch-icon.png><link rel=mask-icon href=https://www.noe.backert.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.noe.backert.fr/ctf/silicondatasleuthing/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=/css/custom.css><meta property="og:url" content="https://www.noe.backert.fr/ctf/silicondatasleuthing/"><meta property="og:site_name" content="Noé Backert | Blog"><meta property="og:title" content="Silicon Data Sleuthing"><meta property="og:description" content="In the dust and sand surrounding the vault, you unearth a rusty PCB... You try to read the etched print, it says Open...W...RT, a router! You hand it over to the hardware gurus and to their surprise the ROM Chip is intact! They manage to read the data off the tarnished silicon and they give you back a firmware image. It's now your job to examine the firmware and maybe recover some useful information that will be important for unlocking and bypassing some of the vault's countermeasures!"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2026-01-24T13:50:00+02:00"><meta property="article:modified_time" content="2026-01-24T13:50:00+02:00"><meta property="article:tag" content="Forensics"><meta property="article:tag" content="ROM"><meta property="article:tag" content="Firmware"><meta name=twitter:card content="summary"><meta name=twitter:title content="Silicon Data Sleuthing"><meta name=twitter:description content="In the dust and sand surrounding the vault, you unearth a rusty PCB... You try to read the etched print, it says Open...W...RT, a router! You hand it over to the hardware gurus and to their surprise the ROM Chip is intact! They manage to read the data off the tarnished silicon and they give you back a firmware image. It's now your job to examine the firmware and maybe recover some useful information that will be important for unlocking and bypassing some of the vault's countermeasures!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"CTFs","item":"https://www.noe.backert.fr/ctf/"},{"@type":"ListItem","position":2,"name":"Silicon Data Sleuthing","item":"https://www.noe.backert.fr/ctf/silicondatasleuthing/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Silicon Data Sleuthing","name":"Silicon Data Sleuthing","description":"In the dust and sand surrounding the vault, you unearth a rusty PCB... You try to read the etched print, it says Open...W...RT, a router! You hand it over to the hardware gurus and to their surprise the ROM Chip is intact! They manage to read the data off the tarnished silicon and they give you back a firmware image. It's now your job to examine the firmware and maybe recover some useful information that will be important for unlocking and bypassing some of the vault's countermeasures!","keywords":["Forensics","ROM","Firmware"],"articleBody":"Challenge Overview Challenge: Silicon Data Sleuthing\nCategory: Forensics\nDifficulty: Easy\nPoints: 975\nSolves: 8\nIn this challenge, we analyze a recovered OpenWrt router firmware image to extract sensitive configuration data. The challenge demonstrates the importance of understanding firmware extraction techniques and the security implications of overlay filesystems in embedded Linux devices.\nChallenge Description In the dust and sand surrounding the vault, you unearth a rusty PCB… You try to read the etched print, it says Open…W…RT, a router! You hand it over to the hardware gurus and to their surprise the ROM Chip is intact! They manage to read the data off the tarnished silicon and they give you back a firmware image. It’s now your job to examine the firmware and maybe recover some useful information that will be important for unlocking and bypassing some of the vault’s countermeasures!\nQuestions to Answer What version of OpenWRT runs on the router? What is the Linux kernel version? What’s the hash of the root account’s password? What is the PPPoE username? What is the PPPoE password? What is the WiFi SSID? What is the WiFi Password? What are the 3 WAN ports that redirect traffic from WAN → LAN? Preliminary inspection We first want to know the file we have:\n1 2 -[~/HTB]$ file chal_router_dump.bin chal_router_dump.bin: data 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 -[~/HTB]$ binwalk chal_router_dump.bin DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 16293 0x3FA5 JBOOT STAG header, image id: 5, timestamp 0x6804112C, image size: 405046424 bytes, image JBOOT checksum: 0xBC00, header JBOOT checksum: 0xC8F 26293 0x66B5 JBOOT STAG header, image id: 2, timestamp 0x3E004310, image size: 135544832 bytes, image JBOOT checksum: 0x9900, header JBOOT checksum: 0x408F 30141 0x75BD JBOOT STAG header, image id: 4, timestamp 0xFF0411F3, image size: 3475395327 bytes, image JBOOT checksum: 0x40FF, header JBOOT checksum: 0x1016 53719 0xD1D7 JBOOT SCH2 kernel header, compression type: none, Entry Point: 0x84000C16, image size: 10127 bytes, data CRC: 0x99033010, Data Address: 0x6500048F, rootfs offset: 0x200228E, rootfs size: 2734686244 bytes, rootfs CRC: 0x62000390, header CRC: 0x99001014, header size: 5007 bytes, cmd line length: 0 bytes 64069 0xFA45 JBOOT STAG header, image id: 4, timestamp 0x24100000, image size: 50365208 bytes, image JBOOT checksum: 0x8000, header JBOOT checksum: 0x554 74645 0x12395 JBOOT STAG header, image id: 6, timestamp 0xE200C910, image size: 2148811007 bytes, image JBOOT checksum: 0x610, header JBOOT checksum: 0x2100 97696 0x17DA0 U-Boot version string, \"U-Boot 1.1.3 (Aug 18 2020 - 11:10:29)\" 98248 0x17FC8 CRC32 polynomial table, little endian 99521 0x184C1 DER SHA1 hash 99600 0x18510 AES S-Box 100380 0x1881C AES Inverse S-Box 458752 0x70000 gzip compressed data, maximum compression, from Unix, last modified: 2021-09-17 15:32:23 1572864 0x180000 uImage header, header size: 64 bytes, header CRC: 0x95E11ADB, created: 2023-10-09 21:45:35, image size: 2802312 bytes, Data Address: 0x80001000, Entry Point: 0x80001000, data CRC: 0x8055BE8E, OS: Linux, CPU: MIPS, image type: OS Kernel Image, compression type: none, image name: \"MIPS OpenWrt Linux-5.15.134\" 1578428 0x1815BC Copyright string: \"Copyright (C) 2011 Gabor Juhos \" 1578636 0x18168C LZMA compressed data, properties: 0x6D, dictionary size: 8388608 bytes, uncompressed size: 9229911 bytes 4375240 0x42C2C8 Squashfs filesystem, little endian, version 4.0, compression:xz, size: 3687796 bytes, 1328 inodes, blocksize: 262144 bytes, created: 2023-10-09 21:45:35 8126464 0x7C0000 JFFS2 filesystem, little endian Filesystems Identified (why they matter) SquashFS: A compressed, read-only filesystem designed for embedded systems. It minimizes storage footprint (here, xz-compressed) and holds factory-default files under /rom. Because it is immutable, it cannot be changed at runtime. JFFS2 (Journaling Flash File System v2): A writable filesystem for raw flash (NOR/NAND) with wear-leveling and journaling. On OpenWrt, JFFS2 is mounted as the overlay (/overlay) and merged over /rom to form the live root (/). User changes (passwords, network configs, firewall rules) persist here across reboots. In practice, OpenWrt combines both via overlayfs: the immutable SquashFS provides the base system, while JFFS2 stores all runtime modifications. This is why sensitive data (e.g., the real root password hash and custom firewall DNAT redirects) are found in the JFFS2 overlay rather than the SquashFS.\nCarving SquashFS by signature (“hsqs”) To locate the SquashFS superblock inside the raw dump, we search for its magic string:\n1 grep -oba \"hsqs\" chal_router_dump.bin -a: Treat binary as text for matching. -b: Print the byte offset of each match. -o: Print only the matching part (here, hsqs). SquashFS uses the ASCII magic hsqs at the start of its superblock (little-endian representation of the filesystem signature). The output 4375240:hsqs tells us the superblock begins at byte offset 4,375,240.\nWe then carve the filesystem starting at that offset to the end of the file:\n1 dd if=chal_router_dump.bin of=squashfs.img bs=1 skip=4375240 if: input file (the full chip dump). of: output file (the carved SquashFS image). bs=1: Use a 1-byte block size so skip is in exact bytes. skip=4375240: Skip precisely to the SquashFS superblock. Tip: Using bs=1 avoids off-by-block errors (default dd blocks are 512 bytes). After carving, verify with file squashfs.img (should report a SquashFS v4 image), then extract with unsquashfs.\nSolution Step 1: Firmware Analysis \u0026 Extraction Initial analysis reveals the firmware image contains multiple filesystems:\n1 2 3 4 -[~/HTB]$ binwalk squashfs.img DECIMAL HEXADECIMAL DESCRIPTION 0 0x0 Squashfs filesystem... 3751224 0x393D38 JFFS2 filesystem... Extract the firmware:\n1 -[~/HTB]$ binwalk -e squashfs.img This creates two key components:\nSquashFS (0.squashfs): Read-only root filesystem JFFS2 (393D38.jffs2): Writable overlay partition Step 2: Understanding the Filesystem Hierarchy OpenWrt uses an overlay filesystem architecture:\n/rom → SquashFS (read-only, factory defaults) / → JFFS2 (read-write, user modifications) This allows configuration changes to persist across reboots without modifying the immutable ROM.\nStep 3: Extract JFFS2 Overlay Use jefferson to unpack the JFFS2 partition:\n1 -[~/HTB]$ jefferson 393D38.jffs2 -d jffs2-root The JFFS2 partition contains:\nupper/: Overlay filesystem (modified files) work/: JFFS2 working directory Step 4: Extract Sysupgrade Archive Within the overlay, find sysupgrade.tgz - the backup containing all configuration:\n1 2 -[~/HTB]$ cd _squashfs.img.extracted/jffs2-root/upper -[~/HTB/_squashfs.img.extracted/jffs2-root/upper]$ tar -xzf sysupgrade.tgz This exposes the etc/ directory with all configuration files.\nAnswering the Questions 1. OpenWrt Version 1 2 -[~/HTB/_squashfs.img.extracted/squashfs-root]$ cat etc/os-release VERSION=\"23.05.0\" Answer: 23.05.0\n2. Linux Kernel Version 1 2 -[~/HTB/_squashfs.img.extracted/squashfs-root]$ ls ./lib/modules 5.15.134 Answer: 5.15.134\n3. Root Password Hash This is the key insight: the SquashFS shadow file is empty (root:::...), but the overlay contains the actual hash:\n1 2 -[~/HTB]$ cat _squashfs.img.extracted/jffs2-root/upper/etc/shadow root:$1$YfuRJudo$cXCiIJXn9fWLIt8WY2Okp1:19804:0:99999:7::: Answer: root:$1$YfuRJudo$cXCiIJXn9fWLIt8WY2Okp1:19804:0:99999:7:::\nWhy this matters: The root filesystem is immutable; password changes are stored in the JFFS2 overlay. This is how users can modify passwords without corrupting the factory image.\n4 \u0026 5. PPPoE Credentials Located in UCI (Unified Configuration Interface) config:\n1 2 3 4 5 $ cat etc/config/network | grep -A 5 pppoe config interface 'wan' option proto 'pppoe' option username 'yohZ5ah' option password 'ae-h+i$i^Ngohroorie!bieng6kee7oh' Answers:\nUsername: yohZ5ah Password: ae-h+i$i^Ngohroorie!bieng6kee7oh 6 \u0026 7. WiFi SSID and Password Located in wireless configuration:\n1 2 3 4 5 6 7 $ cat etc/config/wireless | grep -E \"ssid|key\" option ssid 'VLT-AP01' option key 'french-halves-vehicular-favorable' option wpa_disable_eapol_key_retries '1' option ssid 'VLT-AP01' option key 'french-halves-vehicular-favorable' option wpa_disable_eapol_key_retries '1' Answers:\nSSID: VLT-AP01 Password: french-halves-vehicular-favorable 8. WAN Redirect Ports The firewall configuration contains DNAT rules mapping WAN ports to internal LAN services:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $ cat etc/config/firewall | grep -A 5 \"redirect\" config redirect option dest 'lan' option target 'DNAT' option name 'DB' option src 'wan' option src_dport '1778' -- config redirect option dest 'lan' option target 'DNAT' option name 'WEB' option src 'wan' option src_dport '2289' -- config redirect option dest 'lan' option target 'DNAT' option name 'NAS' option src 'wan' option src_dport '8088' Answer: 1778,2289,8088 (numerically sorted)\nKey Takeaways Overlay Filesystems: Understanding how OpenWrt uses SquashFS + JFFS2 overlays is critical for firmware forensics.\nConfiguration Persistence: Mutable data (passwords, network settings) is stored in writable overlays, not the immutable ROM.\nFirmware Extraction Tools:\nbinwalk: Identify and extract embedded filesystems jefferson: Unpack JFFS2 partitions Standard archiving tools (tar, gunzip) for config backups Security Implications: Router firmware often contains plaintext credentials. Proper access controls and encryption are essential.\nTools Used binwalk - Firmware analysis and extraction jefferson - JFFS2 extraction tar - Archive extraction Standard Unix utilities (cat, grep, strings) References OpenWrt Documentation JFFS2 Filesystem SquashFS Binwalk - Firmware Analysis Tool ","wordCount":"1368","inLanguage":"en","datePublished":"2026-01-24T13:50:00+02:00","dateModified":"2026-01-24T13:50:00+02:00","author":{"@type":"Person","name":"Noé Backert"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.noe.backert.fr/ctf/silicondatasleuthing/"},"publisher":{"@type":"Organization","name":"Noé Backert | Blog","logo":{"@type":"ImageObject","url":"https://www.noe.backert.fr/img/favicon.ico"}}}</script><script>window.MathJax={tex:{inlineMath:[["\\(","\\)"],["$","$"]],displayMath:[["$$","$$"],["\\[","\\]"]]},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js async></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.noe.backert.fr/ accesskey=h title="Noé Backert | Blog (Alt + H)">Noé Backert | Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.noe.backert.fr/ title=Home><span>Home</span></a></li><li><a href=https://www.noe.backert.fr/resume/ title=Resume><span>Resume</span></a></li><li><a href=https://www.noe.backert.fr/ctf/ title="CTF Writeups"><span>CTF Writeups</span></a></li><li><a href=https://www.noe.backert.fr/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://www.noe.backert.fr/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.noe.backert.fr/>Home</a>&nbsp;»&nbsp;<a href=https://www.noe.backert.fr/ctf/>CTFs</a></div><h1 class="post-title entry-hint-parent"><span class=ctf-platform-title>HTB</span><span class=ctf-platform-separator> &mdash; </span>Silicon Data Sleuthing</h1><div class=post-description>In the dust and sand surrounding the vault, you unearth a rusty PCB... You try to read the etched print, it says Open...W...RT, a router! You hand it over to the hardware gurus and to their surprise the ROM Chip is intact! They manage to read the data off the tarnished silicon and they give you back a firmware image. It's now your job to examine the firmware and maybe recover some useful information that will be important for unlocking and bypassing some of the vault's countermeasures!</div><div class=post-meta><span title='2026-01-24 13:50:00 +0200 +0200'>January 24, 2026</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Noé Backert</div></header><div class=post-content><h2 id=challenge-overview>Challenge Overview<a hidden class=anchor aria-hidden=true href=#challenge-overview>#</a></h2><p><strong>Challenge:</strong> Silicon Data Sleuthing<br><strong>Category:</strong> Forensics<br><strong>Difficulty:</strong> Easy<br><strong>Points:</strong> 975<br><strong>Solves:</strong> 8</p><p>In this challenge, we analyze a recovered OpenWrt router firmware image to extract sensitive configuration data. The challenge demonstrates the importance of understanding firmware extraction techniques and the security implications of overlay filesystems in embedded Linux devices.</p><h2 id=challenge-description>Challenge Description<a hidden class=anchor aria-hidden=true href=#challenge-description>#</a></h2><blockquote><p>In the dust and sand surrounding the vault, you unearth a rusty PCB&mldr; You try to read the etched print, it says Open&mldr;W&mldr;RT, a router! You hand it over to the hardware gurus and to their surprise the ROM Chip is intact! They manage to read the data off the tarnished silicon and they give you back a firmware image. It&rsquo;s now your job to examine the firmware and maybe recover some useful information that will be important for unlocking and bypassing some of the vault&rsquo;s countermeasures!</p></blockquote><h2 id=questions-to-answer>Questions to Answer<a hidden class=anchor aria-hidden=true href=#questions-to-answer>#</a></h2><ol><li>What version of OpenWRT runs on the router?</li><li>What is the Linux kernel version?</li><li>What&rsquo;s the hash of the root account&rsquo;s password?</li><li>What is the PPPoE username?</li><li>What is the PPPoE password?</li><li>What is the WiFi SSID?</li><li>What is the WiFi Password?</li><li>What are the 3 WAN ports that redirect traffic from WAN → LAN?</li></ol><h2 id=preliminary-inspection>Preliminary inspection<a hidden class=anchor aria-hidden=true href=#preliminary-inspection>#</a></h2><p>We first want to know the file we have:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB<span class=o>]</span>$ file chal_router_dump.bin
</span></span><span class=line><span class=cl>chal_router_dump.bin: data
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB<span class=o>]</span>$ binwalk chal_router_dump.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class=line><span class=cl>--------------------------------------------------------------------------------
</span></span><span class=line><span class=cl><span class=m>16293</span>         0x3FA5          JBOOT STAG header, image id: 5, timestamp 0x6804112C, image size: <span class=m>405046424</span> bytes, image JBOOT checksum: 0xBC00, header JBOOT checksum: 0xC8F
</span></span><span class=line><span class=cl><span class=m>26293</span>         0x66B5          JBOOT STAG header, image id: 2, timestamp 0x3E004310, image size: <span class=m>135544832</span> bytes, image JBOOT checksum: 0x9900, header JBOOT checksum: 0x408F
</span></span><span class=line><span class=cl><span class=m>30141</span>         0x75BD          JBOOT STAG header, image id: 4, timestamp 0xFF0411F3, image size: <span class=m>3475395327</span> bytes, image JBOOT checksum: 0x40FF, header JBOOT checksum: 0x1016
</span></span><span class=line><span class=cl><span class=m>53719</span>         0xD1D7          JBOOT SCH2 kernel header, compression type: none, Entry Point: 0x84000C16, image size: <span class=m>10127</span> bytes, data CRC: 0x99033010, Data Address: 0x6500048F, rootfs offset: 0x200228E, rootfs size: <span class=m>2734686244</span> bytes, rootfs CRC: 0x62000390, header CRC: 0x99001014, header size: <span class=m>5007</span> bytes, cmd line length: <span class=m>0</span> bytes
</span></span><span class=line><span class=cl><span class=m>64069</span>         0xFA45          JBOOT STAG header, image id: 4, timestamp 0x24100000, image size: <span class=m>50365208</span> bytes, image JBOOT checksum: 0x8000, header JBOOT checksum: 0x554
</span></span><span class=line><span class=cl><span class=m>74645</span>         0x12395         JBOOT STAG header, image id: 6, timestamp 0xE200C910, image size: <span class=m>2148811007</span> bytes, image JBOOT checksum: 0x610, header JBOOT checksum: 0x2100
</span></span><span class=line><span class=cl><span class=m>97696</span>         0x17DA0         U-Boot version string, <span class=s2>&#34;U-Boot 1.1.3 (Aug 18 2020 - 11:10:29)&#34;</span>
</span></span><span class=line><span class=cl><span class=m>98248</span>         0x17FC8         CRC32 polynomial table, little endian
</span></span><span class=line><span class=cl><span class=m>99521</span>         0x184C1         DER SHA1 <span class=nb>hash</span>
</span></span><span class=line><span class=cl><span class=m>99600</span>         0x18510         AES S-Box
</span></span><span class=line><span class=cl><span class=m>100380</span>        0x1881C         AES Inverse S-Box
</span></span><span class=line><span class=cl><span class=m>458752</span>        0x70000         gzip compressed data, maximum compression, from Unix, last modified: 2021-09-17 15:32:23
</span></span><span class=line><span class=cl><span class=m>1572864</span>       0x180000        uImage header, header size: <span class=m>64</span> bytes, header CRC: 0x95E11ADB, created: 2023-10-09 21:45:35, image size: <span class=m>2802312</span> bytes, Data Address: 0x80001000, Entry Point: 0x80001000, data CRC: 0x8055BE8E, OS: Linux, CPU: MIPS, image type: OS Kernel Image, compression type: none, image name: <span class=s2>&#34;MIPS OpenWrt Linux-5.15.134&#34;</span>
</span></span><span class=line><span class=cl><span class=m>1578428</span>       0x1815BC        Copyright string: <span class=s2>&#34;Copyright (C) 2011 Gabor Juhos &lt;juhosg@openwrt.org&gt;&#34;</span>
</span></span><span class=line><span class=cl><span class=m>1578636</span>       0x18168C        LZMA compressed data, properties: 0x6D, dictionary size: <span class=m>8388608</span> bytes, uncompressed size: <span class=m>9229911</span> bytes
</span></span><span class=line><span class=cl><span class=m>4375240</span>       0x42C2C8        Squashfs filesystem, little endian, version 4.0, compression:xz, size: <span class=m>3687796</span> bytes, <span class=m>1328</span> inodes, blocksize: <span class=m>262144</span> bytes, created: 2023-10-09 21:45:35
</span></span><span class=line><span class=cl><span class=m>8126464</span>       0x7C0000        JFFS2 filesystem, little endian
</span></span></code></pre></td></tr></table></div></div><h3 id=filesystems-identified-why-they-matter>Filesystems Identified (why they matter)<a hidden class=anchor aria-hidden=true href=#filesystems-identified-why-they-matter>#</a></h3><ul><li><strong>SquashFS:</strong> A compressed, read-only filesystem designed for embedded systems. It minimizes storage footprint (here, xz-compressed) and holds factory-default files under <code>/rom</code>. Because it is immutable, it cannot be changed at runtime.</li><li><strong>JFFS2 (Journaling Flash File System v2):</strong> A writable filesystem for raw flash (NOR/NAND) with wear-leveling and journaling. On OpenWrt, JFFS2 is mounted as the overlay (<code>/overlay</code>) and merged over <code>/rom</code> to form the live root (<code>/</code>). User changes (passwords, network configs, firewall rules) persist here across reboots.</li></ul><p>In practice, OpenWrt combines both via overlayfs: the immutable SquashFS provides the base system, while JFFS2 stores all runtime modifications. This is why sensitive data (e.g., the real <code>root</code> password hash and custom firewall DNAT redirects) are found in the JFFS2 overlay rather than the SquashFS.</p><h3 id=carving-squashfs-by-signature-hsqs>Carving SquashFS by signature (&ldquo;hsqs&rdquo;)<a hidden class=anchor aria-hidden=true href=#carving-squashfs-by-signature-hsqs>#</a></h3><p>To locate the SquashFS superblock inside the raw dump, we search for its magic string:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep -oba <span class=s2>&#34;hsqs&#34;</span> chal_router_dump.bin
</span></span></code></pre></td></tr></table></div></div><ul><li><code>-a</code>: Treat binary as text for matching.</li><li><code>-b</code>: Print the byte offset of each match.</li><li><code>-o</code>: Print only the matching part (here, <code>hsqs</code>).</li></ul><p>SquashFS uses the ASCII magic <code>hsqs</code> at the start of its superblock (little-endian representation of the filesystem signature). The output <code>4375240:hsqs</code> tells us the superblock begins at byte offset <code>4,375,240</code>.</p><p>We then carve the filesystem starting at that offset to the end of the file:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>chal_router_dump.bin <span class=nv>of</span><span class=o>=</span>squashfs.img <span class=nv>bs</span><span class=o>=</span><span class=m>1</span> <span class=nv>skip</span><span class=o>=</span><span class=m>4375240</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>if</code>: input file (the full chip dump).</li><li><code>of</code>: output file (the carved SquashFS image).</li><li><code>bs=1</code>: Use a 1-byte block size so <code>skip</code> is in exact bytes.</li><li><code>skip=4375240</code>: Skip precisely to the SquashFS superblock.</li></ul><p>Tip: Using <code>bs=1</code> avoids off-by-block errors (default dd blocks are 512 bytes). After carving, verify with <code>file squashfs.img</code> (should report a SquashFS v4 image), then extract with <code>unsquashfs</code>.</p><h2 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h2><h3 id=step-1-firmware-analysis--extraction>Step 1: Firmware Analysis & Extraction<a hidden class=anchor aria-hidden=true href=#step-1-firmware-analysis--extraction>#</a></h3><p>Initial analysis reveals the firmware image contains multiple filesystems:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB<span class=o>]</span>$ binwalk squashfs.img
</span></span><span class=line><span class=cl>DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class=line><span class=cl><span class=m>0</span>             0x0             Squashfs filesystem...
</span></span><span class=line><span class=cl><span class=m>3751224</span>       0x393D38        JFFS2 filesystem...
</span></span></code></pre></td></tr></table></div></div><p>Extract the firmware:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB<span class=o>]</span>$ binwalk -e squashfs.img
</span></span></code></pre></td></tr></table></div></div><p>This creates two key components:</p><ul><li><strong>SquashFS</strong> (<code>0.squashfs</code>): Read-only root filesystem</li><li><strong>JFFS2</strong> (<code>393D38.jffs2</code>): Writable overlay partition</li></ul><h3 id=step-2-understanding-the-filesystem-hierarchy>Step 2: Understanding the Filesystem Hierarchy<a hidden class=anchor aria-hidden=true href=#step-2-understanding-the-filesystem-hierarchy>#</a></h3><p>OpenWrt uses an overlay filesystem architecture:</p><ul><li><code>/rom</code> → SquashFS (read-only, factory defaults)</li><li><code>/</code> → JFFS2 (read-write, user modifications)</li></ul><p>This allows configuration changes to persist across reboots without modifying the immutable ROM.</p><h3 id=step-3-extract-jffs2-overlay>Step 3: Extract JFFS2 Overlay<a hidden class=anchor aria-hidden=true href=#step-3-extract-jffs2-overlay>#</a></h3><p>Use <code>jefferson</code> to unpack the JFFS2 partition:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB<span class=o>]</span>$ jefferson 393D38.jffs2 -d jffs2-root
</span></span></code></pre></td></tr></table></div></div><p>The JFFS2 partition contains:</p><ul><li><code>upper/</code>: Overlay filesystem (modified files)</li><li><code>work/</code>: JFFS2 working directory</li></ul><h3 id=step-4-extract-sysupgrade-archive>Step 4: Extract Sysupgrade Archive<a hidden class=anchor aria-hidden=true href=#step-4-extract-sysupgrade-archive>#</a></h3><p>Within the overlay, find <code>sysupgrade.tgz</code> - the backup containing all configuration:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB<span class=o>]</span>$ <span class=nb>cd</span> _squashfs.img.extracted/jffs2-root/upper
</span></span><span class=line><span class=cl>-<span class=o>[</span>~/HTB/_squashfs.img.extracted/jffs2-root/upper<span class=o>]</span>$  tar -xzf sysupgrade.tgz
</span></span></code></pre></td></tr></table></div></div><p>This exposes the <code>etc/</code> directory with all configuration files.</p><h3 id=answering-the-questions>Answering the Questions<a hidden class=anchor aria-hidden=true href=#answering-the-questions>#</a></h3><h4 id=1-openwrt-version>1. OpenWrt Version<a hidden class=anchor aria-hidden=true href=#1-openwrt-version>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB/_squashfs.img.extracted/squashfs-root<span class=o>]</span>$ cat etc/os-release
</span></span><span class=line><span class=cl><span class=nv>VERSION</span><span class=o>=</span><span class=s2>&#34;23.05.0&#34;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Answer:</strong> <code>23.05.0</code></p><h4 id=2-linux-kernel-version>2. Linux Kernel Version<a hidden class=anchor aria-hidden=true href=#2-linux-kernel-version>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB/_squashfs.img.extracted/squashfs-root<span class=o>]</span>$ ls ./lib/modules
</span></span><span class=line><span class=cl>5.15.134
</span></span></code></pre></td></tr></table></div></div><p><strong>Answer:</strong> <code>5.15.134</code></p><h4 id=3-root-password-hash>3. Root Password Hash<a hidden class=anchor aria-hidden=true href=#3-root-password-hash>#</a></h4><p>This is the key insight: the SquashFS shadow file is empty (<code>root:::...</code>), but the overlay contains the actual hash:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/HTB<span class=o>]</span>$ cat _squashfs.img.extracted/jffs2-root/upper/etc/shadow
</span></span><span class=line><span class=cl>root:<span class=nv>$1$YfuRJudo$cXCiIJXn9fWLIt8WY2Okp1</span>:19804:0:99999:7:::
</span></span></code></pre></td></tr></table></div></div><p><strong>Answer:</strong> <code>root:$1$YfuRJudo$cXCiIJXn9fWLIt8WY2Okp1:19804:0:99999:7:::</code></p><p><strong>Why this matters:</strong> The root filesystem is immutable; password changes are stored in the JFFS2 overlay. This is how users can modify passwords without corrupting the factory image.</p><h4 id=4--5-pppoe-credentials>4 & 5. PPPoE Credentials<a hidden class=anchor aria-hidden=true href=#4--5-pppoe-credentials>#</a></h4><p>Located in UCI (Unified Configuration Interface) config:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ cat etc/config/network <span class=p>|</span> grep -A <span class=m>5</span> pppoe
</span></span><span class=line><span class=cl>config interface <span class=s1>&#39;wan&#39;</span>
</span></span><span class=line><span class=cl>    option proto <span class=s1>&#39;pppoe&#39;</span>
</span></span><span class=line><span class=cl>    option username <span class=s1>&#39;yohZ5ah&#39;</span>
</span></span><span class=line><span class=cl>    option password <span class=s1>&#39;ae-h+i$i^Ngohroorie!bieng6kee7oh&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Answers:</strong></p><ul><li>Username: <code>yohZ5ah</code></li><li>Password: <code>ae-h+i$i^Ngohroorie!bieng6kee7oh</code></li></ul><h4 id=6--7-wifi-ssid-and-password>6 & 7. WiFi SSID and Password<a hidden class=anchor aria-hidden=true href=#6--7-wifi-ssid-and-password>#</a></h4><p>Located in wireless configuration:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ cat etc/config/wireless <span class=p>|</span> grep -E <span class=s2>&#34;ssid|key&#34;</span>
</span></span><span class=line><span class=cl>option ssid <span class=s1>&#39;VLT-AP01&#39;</span>
</span></span><span class=line><span class=cl>option key <span class=s1>&#39;french-halves-vehicular-favorable&#39;</span>
</span></span><span class=line><span class=cl>option wpa_disable_eapol_key_retries <span class=s1>&#39;1&#39;</span>
</span></span><span class=line><span class=cl>option ssid <span class=s1>&#39;VLT-AP01&#39;</span>
</span></span><span class=line><span class=cl>option key <span class=s1>&#39;french-halves-vehicular-favorable&#39;</span>
</span></span><span class=line><span class=cl>option wpa_disable_eapol_key_retries <span class=s1>&#39;1&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Answers:</strong></p><ul><li>SSID: <code>VLT-AP01</code></li><li>Password: <code>french-halves-vehicular-favorable</code></li></ul><h4 id=8-wan-redirect-ports>8. WAN Redirect Ports<a hidden class=anchor aria-hidden=true href=#8-wan-redirect-ports>#</a></h4><p>The firewall configuration contains DNAT rules mapping WAN ports to internal LAN services:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>$ cat etc/config/firewall <span class=p>|</span> grep -A <span class=m>5</span> <span class=s2>&#34;redirect&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>config redirect
</span></span><span class=line><span class=cl>        option dest <span class=s1>&#39;lan&#39;</span>
</span></span><span class=line><span class=cl>        option target <span class=s1>&#39;DNAT&#39;</span>
</span></span><span class=line><span class=cl>        option name <span class=s1>&#39;DB&#39;</span>
</span></span><span class=line><span class=cl>        option src <span class=s1>&#39;wan&#39;</span>
</span></span><span class=line><span class=cl>        option src_dport <span class=s1>&#39;1778&#39;</span>
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>config redirect
</span></span><span class=line><span class=cl>        option dest <span class=s1>&#39;lan&#39;</span>
</span></span><span class=line><span class=cl>        option target <span class=s1>&#39;DNAT&#39;</span>
</span></span><span class=line><span class=cl>        option name <span class=s1>&#39;WEB&#39;</span>
</span></span><span class=line><span class=cl>        option src <span class=s1>&#39;wan&#39;</span>
</span></span><span class=line><span class=cl>        option src_dport <span class=s1>&#39;2289&#39;</span>
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>config redirect
</span></span><span class=line><span class=cl>        option dest <span class=s1>&#39;lan&#39;</span>
</span></span><span class=line><span class=cl>        option target <span class=s1>&#39;DNAT&#39;</span>
</span></span><span class=line><span class=cl>        option name <span class=s1>&#39;NAS&#39;</span>
</span></span><span class=line><span class=cl>        option src <span class=s1>&#39;wan&#39;</span>
</span></span><span class=line><span class=cl>        option src_dport <span class=s1>&#39;8088&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Answer:</strong> <code>1778,2289,8088</code> (numerically sorted)</p><h2 id=key-takeaways>Key Takeaways<a hidden class=anchor aria-hidden=true href=#key-takeaways>#</a></h2><ol><li><p><strong>Overlay Filesystems:</strong> Understanding how OpenWrt uses SquashFS + JFFS2 overlays is critical for firmware forensics.</p></li><li><p><strong>Configuration Persistence:</strong> Mutable data (passwords, network settings) is stored in writable overlays, not the immutable ROM.</p></li><li><p><strong>Firmware Extraction Tools:</strong></p><ul><li><code>binwalk</code>: Identify and extract embedded filesystems</li><li><code>jefferson</code>: Unpack JFFS2 partitions</li><li>Standard archiving tools (<code>tar</code>, <code>gunzip</code>) for config backups</li></ul></li><li><p><strong>Security Implications:</strong> Router firmware often contains plaintext credentials. Proper access controls and encryption are essential.</p></li></ol><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li><code>binwalk</code> - Firmware analysis and extraction</li><li><code>jefferson</code> - JFFS2 extraction</li><li><code>tar</code> - Archive extraction</li><li>Standard Unix utilities (<code>cat</code>, <code>grep</code>, <code>strings</code>)</li></ul><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://openwrt.org/>OpenWrt Documentation</a></li><li><a href=https://en.wikipedia.org/wiki/JFFS2>JFFS2 Filesystem</a></li><li><a href=https://www.kernel.org/doc/html/latest/filesystems/squashfs.html>SquashFS</a></li><li><a href=https://github.com/ReFirmLabs/binwalk>Binwalk - Firmware Analysis Tool</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.noe.backert.fr/tags/forensics/>Forensics</a></li><li><a href=https://www.noe.backert.fr/tags/rom/>ROM</a></li><li><a href=https://www.noe.backert.fr/tags/firmware/>Firmware</a></li></ul></footer></article><nav class=paginav><a class=prev href=https://www.noe.backert.fr/ctf/trouvezlechat/><span class=title>« Prev</span><br><span>Trouvez le Chat</span>
</a><a class=next href=https://www.noe.backert.fr/ctf/driversshadow/><span class=title>Next »</span><br><span>Driver's Shadow</span></a></nav></main><footer class=footer><span>&copy; 2026 <a href=https://www.noe.backert.fr/>Noé Backert | Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.setAttribute("aria-live","polite"),t.innerHTML="";function s(){t.classList.add("copied"),t.innerHTML="",setTimeout(()=>{t.classList.remove("copied"),t.innerHTML=""},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=/js/lightbox.js></script><script src=/js/code-lang.js></script></body></html>