<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>LDAP User Kerberoastable | Noé Backert | Blog</title><meta name=keywords content="Forensics,AD,Kerberos"><meta name=description content="During your investigation, you recover an LDAP directory backup exported using ldap2json. Use the information contained in this dump to identify the Kerberoastable user."><meta name=author content="Noé Backert"><link rel=canonical href=https://www.noe.backert.fr/ctf/ldapuserkerberoastable/><link crossorigin=anonymous href=/assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://www.noe.backert.fr/img/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.noe.backert.fr/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.noe.backert.fr/favicon-32x32.png><link rel=apple-touch-icon href=https://www.noe.backert.fr/apple-touch-icon.png><link rel=mask-icon href=https://www.noe.backert.fr/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.noe.backert.fr/ctf/ldapuserkerberoastable/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=/css/custom.css><meta property="og:url" content="https://www.noe.backert.fr/ctf/ldapuserkerberoastable/"><meta property="og:site_name" content="Noé Backert | Blog"><meta property="og:title" content="LDAP User Kerberoastable"><meta property="og:description" content="During your investigation, you recover an LDAP directory backup exported using ldap2json. Use the information contained in this dump to identify the Kerberoastable user."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="ctf"><meta property="article:published_time" content="2026-02-20T12:00:00+01:00"><meta property="article:modified_time" content="2026-02-20T12:00:00+01:00"><meta property="article:tag" content="Forensics"><meta property="article:tag" content="AD"><meta property="article:tag" content="Kerberos"><meta name=twitter:card content="summary"><meta name=twitter:title content="LDAP User Kerberoastable"><meta name=twitter:description content="During your investigation, you recover an LDAP directory backup exported using ldap2json. Use the information contained in this dump to identify the Kerberoastable user."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"CTFs","item":"https://www.noe.backert.fr/ctf/"},{"@type":"ListItem","position":2,"name":"LDAP User Kerberoastable","item":"https://www.noe.backert.fr/ctf/ldapuserkerberoastable/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"LDAP User Kerberoastable","name":"LDAP User Kerberoastable","description":"During your investigation, you recover an LDAP directory backup exported using ldap2json. Use the information contained in this dump to identify the Kerberoastable user.","keywords":["Forensics","AD","Kerberos"],"articleBody":"Root-Me Challenge Link\nSolution Context and Objective The challenge provides an LDAP dump of an Active Directory environment, exported in JSON format using ldap2json.\nThe goal is to identify a Kerberoastable user account, meaning:\nA user account that owns a Service Principal Name (SPN), allowing an attacker to request a Ticket Granting Service (TGS) and perform a Kerberoasting attack.\nThe analysis is fully static: no interaction with the Domain Controller is required.\nKerberoasting – Theory Reminder Kerberoasting is a post-exploitation technique T1558.003 in Active Directory where an attacker abuses normal Kerberos behavior to obtain crackable material.\nIn Kerberos:\nA SPN (Service Principal Name) identifies a service account Any authenticated domain user can request a TGS for that SPN The returned TGS is encrypted with the target service account key (derived from its password) If this service account is a regular user account with a weak password, the ticket can be cracked offline to recover the plaintext password Typical Kerberoasting flow:\nEnumerate accounts that have servicePrincipalName Request TGS tickets for those SPNs Export the ticket material Crack it offline (wordlist/rules) Reuse recovered credentials for lateral movement/privilege escalation Because the attack is mostly offline after ticket retrieval, it can be stealthy and does not require continuous interaction with the domain controller.\nA user is Kerberoastable if:\nit is of type user it has a servicePrincipalName the account is enabled it is neither a machine account nor krbtgt Installation / Tools Tools used:\njq – JSON parsing and filtering LDAP dump generated with ldap2json No offensive tooling (Rubeus, Impacket, etc.) is required.\nLDAP Dump Structure Analysis The JSON file is not a flat list, but a full LDAP tree:\nDomain Containers (CN=Users, OU=...) User, group and computer objects A recursive traversal of the JSON structure is therefore required.\nExtracting Accounts with SPNs First step: identify all objects containing a servicePrincipalName.\n1 2 3 4 5 6 -[~/DEV/OSIR/share/cases/Kerberoastable]$ jq ' .. | objects | select(has(\"servicePrincipalName\")) | { user: .sAMAccountName, spn: .servicePrincipalName } ' ch31.json This is the result :\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 { \"user\": \"krbtgt\", \"spn\": [ \"kadmin/changepw\" ] } { \"user\": \"a.newton\", \"spn\": [ \"HTTP/SRV-RDS.rootme.local\" ] } { \"user\": \"DC01$\", \"spn\": [ \"Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/DC01.ROOTME.local\", \"ldap/DC01.ROOTME.local/ForestDnsZones.ROOTME.local\", \"ldap/DC01.ROOTME.local/DomainDnsZones.ROOTME.local\", \"DNS/DC01.ROOTME.local\", \"GC/DC01.ROOTME.local/ROOTME.local\", \"RestrictedKrbHost/DC01.ROOTME.local\", \"RestrictedKrbHost/DC01\", \"RPC/55de6b37-27e0-4d8e-84f1-b54018a48b62._msdcs.ROOTME.local\", \"HOST/DC01/ROOTME\", \"HOST/DC01.ROOTME.local/ROOTME\", \"HOST/DC01\", \"HOST/DC01.ROOTME.local\", \"HOST/DC01.ROOTME.local/ROOTME.local\", \"E3514235-4B06-11D1-AB04-00C04FC2DCD2/55de6b37-27e0-4d8e-84f1-b54018a48b62/ROOTME.local\", \"ldap/DC01/ROOTME\", \"ldap/55de6b37-27e0-4d8e-84f1-b54018a48b62._msdcs.ROOTME.local\", \"ldap/DC01.ROOTME.local/ROOTME\", \"ldap/DC01\", \"ldap/DC01.ROOTME.local\", \"ldap/DC01.ROOTME.local/ROOTME.local\" ] } We can directly see that the only user account is a.newton, because krbtgtis the Kerberos system account, and DC01$ is the machine account and passwords are automatically managed.\nWe can then confirm that this account works, and display his email using the following jq command:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 jq ' .. | objects | select( has(\"objectClass\") and (.objectClass | index(\"user\")) and has(\"servicePrincipalName\") and (.servicePrincipalName | length \u003e 0) and (.sAMAccountName != \"krbtgt\") and ( ((.userAccountControl // 0) | tonumber) == 512 or ((.userAccountControl // 0) | tonumber) == 66048 ) ) | { dn: .distinguishedName, user: .sAMAccountName, spn: .servicePrincipalName, email: .mail, uac: .userAccountControl } ' ch31.json It gives us the following result :\n1 2 3 4 5 6 7 8 9 { \"dn\": \"CN=Alexandria,CN=Users,DC=ROOTME,DC=local\", \"user\": \"a.newton\", \"spn\": [ \"HTTP/SRV-RDS.rootme.local\" ], \"email\": \"alexandria.newton@rootme.local\", \"uac\": 66048 } CONCLUSION The conditions for a user to be Kerberoastable are :\nUAC (UserAccountControl)\n512 → standard enabled user account\n66048 → enabled user account with non-expiring password\nThese values exclude:\ndisabled accounts machine accounts system accounts The email of the Kerberoastable account is then alexandria.newton@rootme.local.\n","wordCount":"616","inLanguage":"en","datePublished":"2026-02-20T12:00:00+01:00","dateModified":"2026-02-20T12:00:00+01:00","author":{"@type":"Person","name":"Noé Backert"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.noe.backert.fr/ctf/ldapuserkerberoastable/"},"publisher":{"@type":"Organization","name":"Noé Backert | Blog","logo":{"@type":"ImageObject","url":"https://www.noe.backert.fr/img/favicon.ico"}}}</script><script>window.MathJax={tex:{inlineMath:[["\\(","\\)"],["$","$"]],displayMath:[["$$","$$"],["\\[","\\]"]]},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js async></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.noe.backert.fr/ accesskey=h title="Noé Backert | Blog (Alt + H)">Noé Backert | Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.noe.backert.fr/ title=Home><span>Home</span></a></li><li><a href=https://www.noe.backert.fr/resume/ title=Resume><span>Resume</span></a></li><li><a href=https://www.noe.backert.fr/ctf/ title="CTF Writeups"><span>CTF Writeups</span></a></li><li><a href=https://www.noe.backert.fr/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://www.noe.backert.fr/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.noe.backert.fr/>Home</a>&nbsp;»&nbsp;<a href=https://www.noe.backert.fr/ctf/>CTFs</a></div><h1 class="post-title entry-hint-parent"><span class=ctf-platform-title>Root-Me</span><span class=ctf-platform-separator> &mdash; </span>LDAP User Kerberoastable</h1><div class=post-description>During your investigation, you recover an LDAP directory backup exported using ldap2json. Use the information contained in this dump to identify the Kerberoastable user.</div><div class=post-meta><span title='2026-02-20 12:00:00 +0100 +0100'>February 20, 2026</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Noé Backert</div></header><div class=post-content><p><a href=https://www.root-me.org/fr/Challenges/Forensic/Windows-LDAP-User-KerbeRoastable/>Root-Me Challenge Link</a></p><h1 id=solution>Solution<a hidden class=anchor aria-hidden=true href=#solution>#</a></h1><h2 id=context-and-objective>Context and Objective<a hidden class=anchor aria-hidden=true href=#context-and-objective>#</a></h2><p>The challenge provides an <strong>LDAP dump</strong> of an Active Directory environment, exported in JSON format using <code>ldap2json</code>.<br>The goal is to identify a <strong>Kerberoastable user account</strong>, meaning:</p><blockquote><p>A user account that owns a <strong>Service Principal Name (SPN)</strong>, allowing an attacker to request a <strong>Ticket Granting Service (TGS)</strong> and perform a <strong>Kerberoasting attack</strong>.</p></blockquote><p>The analysis is <strong>fully static</strong>: no interaction with the Domain Controller is required.</p><hr><h2 id=kerberoasting--theory-reminder>Kerberoasting – Theory Reminder<a hidden class=anchor aria-hidden=true href=#kerberoasting--theory-reminder>#</a></h2><p>Kerberoasting is a post-exploitation technique <a href=https://attack.mitre.org/techniques/T1558/003/>T1558.003</a> in Active Directory where an attacker abuses normal Kerberos behavior to obtain crackable material.</p><p>In Kerberos:</p><ul><li>A <strong>SPN</strong> (Service Principal Name) identifies a service account</li><li>Any authenticated domain user can request a <strong>TGS</strong> for that SPN</li><li>The returned TGS is encrypted with the target service account key (derived from its password)</li><li>If this service account is a <strong>regular user account</strong> with a weak password, the ticket can be cracked <strong>offline</strong> to recover the plaintext password</li></ul><p>Typical Kerberoasting flow:</p><ol><li>Enumerate accounts that have <code>servicePrincipalName</code></li><li>Request TGS tickets for those SPNs</li><li>Export the ticket material</li><li>Crack it offline (wordlist/rules)</li><li>Reuse recovered credentials for lateral movement/privilege escalation</li></ol><p>Because the attack is mostly offline after ticket retrieval, it can be stealthy and does not require continuous interaction with the domain controller.</p><p>A user is <strong>Kerberoastable</strong> if:</p><ul><li>it is of type <code>user</code></li><li>it has a <code>servicePrincipalName</code></li><li>the account is enabled</li><li>it is <strong>neither a machine account nor <code>krbtgt</code></strong></li></ul><hr><h2 id=installation--tools>Installation / Tools<a hidden class=anchor aria-hidden=true href=#installation--tools>#</a></h2><p>Tools used:</p><ul><li><code>jq</code> – JSON parsing and filtering</li><li>LDAP dump generated with <code>ldap2json</code></li></ul><p>No offensive tooling (Rubeus, Impacket, etc.) is required.</p><hr><h2 id=ldap-dump-structure-analysis>LDAP Dump Structure Analysis<a hidden class=anchor aria-hidden=true href=#ldap-dump-structure-analysis>#</a></h2><p>The JSON file is <strong>not a flat list</strong>, but a <strong>full LDAP tree</strong>:</p><ul><li>Domain</li><li>Containers (<code>CN=Users</code>, <code>OU=...</code>)</li><li>User, group and computer objects</li></ul><p>A <strong>recursive traversal</strong> of the JSON structure is therefore required.</p><hr><h2 id=extracting-accounts-with-spns>Extracting Accounts with SPNs<a hidden class=anchor aria-hidden=true href=#extracting-accounts-with-spns>#</a></h2><p>First step: identify <strong>all objects containing a <code>servicePrincipalName</code></strong>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>-<span class=o>[</span>~/DEV/OSIR/share/cases/Kerberoastable<span class=o>]</span>$ jq <span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>..
</span></span></span><span class=line><span class=cl><span class=s1>| objects
</span></span></span><span class=line><span class=cl><span class=s1>| select(has(&#34;servicePrincipalName&#34;))
</span></span></span><span class=line><span class=cl><span class=s1>| { user: .sAMAccountName, spn: .servicePrincipalName }
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span> ch31.json
</span></span></code></pre></td></tr></table></div></div><p>This is the result :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;krbtgt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;spn&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;kadmin/changepw&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;a.newton&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;spn&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HTTP/SRV-RDS.rootme.local&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;DC01$&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;spn&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/DC01.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/DC01.ROOTME.local/ForestDnsZones.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/DC01.ROOTME.local/DomainDnsZones.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;DNS/DC01.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;GC/DC01.ROOTME.local/ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;RestrictedKrbHost/DC01.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;RestrictedKrbHost/DC01&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;RPC/55de6b37-27e0-4d8e-84f1-b54018a48b62._msdcs.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HOST/DC01/ROOTME&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HOST/DC01.ROOTME.local/ROOTME&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HOST/DC01&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HOST/DC01.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HOST/DC01.ROOTME.local/ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;E3514235-4B06-11D1-AB04-00C04FC2DCD2/55de6b37-27e0-4d8e-84f1-b54018a48b62/ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/DC01/ROOTME&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/55de6b37-27e0-4d8e-84f1-b54018a48b62._msdcs.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/DC01.ROOTME.local/ROOTME&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/DC01&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/DC01.ROOTME.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;ldap/DC01.ROOTME.local/ROOTME.local&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>We can directly see that the only user account is <code>a.newton</code>, because <code>krbtgt</code>is the Kerberos system account, and <code>DC01$</code> is the machine account and passwords are automatically managed.</p><p>We can then confirm that this account works, and display his email using the following <code>jq</code> command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>jq <span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>..
</span></span></span><span class=line><span class=cl><span class=s1>| objects
</span></span></span><span class=line><span class=cl><span class=s1>| select(
</span></span></span><span class=line><span class=cl><span class=s1>    has(&#34;objectClass&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    and (.objectClass | index(&#34;user&#34;))
</span></span></span><span class=line><span class=cl><span class=s1>    and has(&#34;servicePrincipalName&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    and (.servicePrincipalName | length &gt; 0)
</span></span></span><span class=line><span class=cl><span class=s1>    and (.sAMAccountName != &#34;krbtgt&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    and (
</span></span></span><span class=line><span class=cl><span class=s1>        ((.userAccountControl // 0) | tonumber) == 512
</span></span></span><span class=line><span class=cl><span class=s1>        or
</span></span></span><span class=line><span class=cl><span class=s1>        ((.userAccountControl // 0) | tonumber) == 66048
</span></span></span><span class=line><span class=cl><span class=s1>    )
</span></span></span><span class=line><span class=cl><span class=s1>)
</span></span></span><span class=line><span class=cl><span class=s1>| {
</span></span></span><span class=line><span class=cl><span class=s1>    dn: .distinguishedName,
</span></span></span><span class=line><span class=cl><span class=s1>    user: .sAMAccountName,
</span></span></span><span class=line><span class=cl><span class=s1>    spn: .servicePrincipalName,
</span></span></span><span class=line><span class=cl><span class=s1>    email: .mail,
</span></span></span><span class=line><span class=cl><span class=s1>    uac: .userAccountControl
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span> ch31.json
</span></span></code></pre></td></tr></table></div></div><p>It gives us the following result :</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;dn&#34;</span><span class=p>:</span> <span class=s2>&#34;CN=Alexandria,CN=Users,DC=ROOTME,DC=local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;user&#34;</span><span class=p>:</span> <span class=s2>&#34;a.newton&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;spn&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;HTTP/SRV-RDS.rootme.local&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>],</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;email&#34;</span><span class=p>:</span> <span class=s2>&#34;alexandria.newton@rootme.local&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;uac&#34;</span><span class=p>:</span> <span class=mi>66048</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=conclusion>CONCLUSION<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h1><p>The conditions for a user to be Kerberoastable are :</p><p><strong>UAC</strong> (UserAccountControl)</p><ul><li><p>512 → standard enabled user account</p></li><li><p>66048 → enabled user account with non-expiring password</p></li></ul><p>These values exclude:</p><ul><li>disabled accounts</li><li>machine accounts</li><li>system accounts</li></ul><p>The email of the Kerberoastable account is then <code>alexandria.newton@rootme.local</code>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.noe.backert.fr/tags/forensics/>Forensics</a></li><li><a href=https://www.noe.backert.fr/tags/ad/>AD</a></li><li><a href=https://www.noe.backert.fr/tags/kerberos/>Kerberos</a></li></ul></footer></article><nav class=paginav><a class=prev href=https://www.noe.backert.fr/ctf/ldapuserasreproastable/><span class=title>« Prev</span><br><span>Windows - LDAP User As_RepRoastable</span>
</a><a class=next href=https://www.noe.backert.fr/ctf/trouvezlechat/><span class=title>Next »</span><br><span>Trouvez le Chat</span></a></nav></main><footer class=footer><span>&copy; 2026 <a href=https://www.noe.backert.fr/>Noé Backert | Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.setAttribute("aria-live","polite"),t.innerHTML="";function s(){t.classList.add("copied"),t.innerHTML="",setTimeout(()=>{t.classList.remove("copied"),t.innerHTML=""},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script src=/js/lightbox.js></script><script src=/js/code-lang.js></script></body></html>